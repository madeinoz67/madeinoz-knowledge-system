# OSINT/CTI Ontology Configuration
# Feature: 018-osint-ontology
# Phase 3: User Story 1 - Custom Entity Types
#
# This configuration defines custom entity and relationship types for Cyber Threat
# Intelligence (CTI) and Open Source Intelligence (OSINT) work.
#
# Entity Types: 7 CTI types (ThreatActor, Malware, Vulnerability, Campaign, Indicator, Infrastructure, TTP)
#               6 OSINT types (Account, Domain, Email, Phone, Image, Investigation)
# Relationship Types: 8 CTI relationship types (uses, targets, associated_with, attributed_to, exploits, variant_of, located_at, communicates_with)
#                     9 OSINT relationship types (owns, registered_to, hosted_on, contacted_via, contains, investigates, links_to, exposes, variants_of)

version: "1.1.0"
name: "CTI+OSINT Base Ontology"
description: "Combined Cyber Threat Intelligence and Open Source Intelligence ontology for CTI/OSINT analysis"

# Custom entity types define domain-specific entities that can be automatically
# extracted from content and classified with these types.
entity_types:
  - name: "ThreatActor"
    description: "Actor responsible for cyber threats, including APT groups, threat actors, and malicious actors"
    icon: "user-secret"
    permanent: false
    decay_config:
      half_life_days: 180  # CTI data has long-term relevance
      importance_floor: 0.5  # Maintain baseline importance
      stability_multiplier: 1.2  # Boost stability for threat actors
    attributes:
      - name: "aliases"
        type: "list"
        required: false
        description: "Alternative names or aliases for the threat actor (e.g., APT28, Fancy Bear, Sofacy)"
      - name: "sophistication"
        type: "string"
        required: false
        description: "Technical sophistication level (e.g., advanced, moderate, novice)"
      - name: "country"
        type: "string"
        required: false
        description: "Country of origin or attributed country"
      - name: "motivation"
        type: "string"
        required: false
        description: "Primary motivation (e.g., espionage, financial, political, sabotage)"
      - name: "first_seen"
        type: "datetime"
        required: false
        description: "Date when the threat actor was first observed"

  - name: "Malware"
    description: "Malicious software, including viruses, worms, trojans, ransomware, and other malicious code"
    icon: "bug"
    permanent: false
    decay_config:
      half_life_days: 90  # Malware evolves more quickly
      importance_floor: 0.4
      stability_multiplier: 0.9  # Slightly reduced stability
    attributes:
      - name: "family"
        type: "string"
        required: false
        description: "Malware family name (e.g., LockBit, Cobalt Strike, Emotet)"
      - name: "first_seen"
        type: "datetime"
        required: false
        description: "When the malware was first observed"
      - name: "capabilities"
        type: "list"
        required: false
        description: "List of capabilities (e.g., ransomware, data exfiltration, remote access)"
      - name: "platforms"
        type: "list"
        required: false
        description: "Affected platforms (e.g., Windows, Linux, macOS)"
      - name: "malware_type"
        type: "string"
        required: false
        description: "Type of malware (e.g., ransomware, trojan, backdoor, spyware)"

  - name: "Vulnerability"
    description: "Security vulnerability, including CVE entries and security flaws"
    icon: "shield-virus"
    permanent: false
    decay_config:
      half_life_days: 180  # Vulnerabilities have long-term relevance
      importance_floor: 0.5
      stability_multiplier: 1.1
    attributes:
      - name: "cve_id"
        type: "string"
        required: false
        description: "CVE identifier (e.g., CVE-2024-1234)"
      - name: "cvss_score"
        type: "number"
        required: false
        description: "CVSS severity score (0.0-10.0)"
      - name: "cvss_vector"
        type: "string"
        required: false
        description: "CVSS vector string"
      - name: "description"
        type: "string"
        required: false
        description: "Description of the vulnerability"
      - name: "patched_versions"
        type: "list"
        required: false
        description: "List of patched software versions"
      - name: "exploit_available"
        type: "boolean"
        required: false
        description: "Whether public exploit code is available"
      - name: "published_date"
        type: "datetime"
        required: false
        description: "Date the vulnerability was published"

  - name: "Campaign"
    description: "Coordinated set of malicious activities with a common goal, often attributed to specific threat actors"
    icon: "project-diagram"
    permanent: false
    decay_config:
      half_life_days: 120  # Campaigns have medium-term relevance
      importance_floor: 0.4
      stability_multiplier: 1.0
    attributes:
      - name: "first_seen"
        type: "datetime"
        required: false
        description: "When the campaign was first observed"
      - name: "last_seen"
        type: "datetime"
        required: false
        description: "When the campaign was last observed"
      - name: "description"
        type: "string"
        required: false
        description: "Description of the campaign's objectives and activities"
      - name: "status"
        type: "string"
        required: false
        description: "Campaign status (e.g., active, dormant, ended)"
      - name: "target_sector"
        type: "string"
        required: false
        description: "Primary target sector (e.g., finance, healthcare, government)"

  - name: "Indicator"
    description: "IOCs (Indicators of Compromise) including file hashes, IP addresses, domain names, URLs"
    icon: "fingerprint"
    permanent: false
    decay_config:
      half_life_days: 90  # Indicators change frequently
      importance_floor: 0.3  # Lower floor as indicators become stale quickly
      stability_multiplier: 0.8  # Reduced stability
    attributes:
      - name: "pattern"
        type: "string"
        required: false
        description: "Indicator pattern (e.g., IP address, domain, hash, URL)"
      - name: "pattern_type"
        type: "string"
        required: false
        description: "Indicator type (e.g., ipv4-addr, domain, file-hash, url)"
      - name: "valid_from"
        type: "datetime"
        required: false
        description: "Start of indicator validity period"
      - name: "valid_until"
        type: "datetime"
        required: false
        description: "End of indicator validity period"
      - name: "confidence"
        type: "string"
        required: false
        description: "Confidence level (e.g., high, medium, low)"
      - name: "source"
        type: "string"
        required: false
        description: "Source of the indicator"

  - name: "Infrastructure"
    description: "Infrastructure used by threat actors, including C2 servers, staging servers, and attack infrastructure"
    icon: "server"
    permanent: false
    decay_config:
      half_life_days: 60  # Infrastructure changes frequently
      importance_floor: 0.3
      stability_multiplier: 0.7  # Low stability - infrastructure is dynamic
    attributes:
      - name: "type"
        type: "string"
        required: false
        description: "Infrastructure type (e.g., c2-server, staging-server, phishing-server)"
      - name: "address"
        type: "string"
        required: false
        description: "IP address, domain name, or URL"
      - name: "is_active"
        type: "boolean"
        required: false
        description: "Whether the infrastructure is currently active"
      - name: "first_seen"
        type: "datetime"
        required: false
        description: "When the infrastructure was first observed"
      - name: "last_seen"
        type: "datetime"
        required: false
        description: "When the infrastructure was last observed"
      - name: "as_number"
        type: "string"
        required: false
        description: "Autonomous System number"

  - name: "TTP"
    description: "Tactics, Techniques, and Procedures (TTPs) describing how threat actors operate, mapped to MITRE ATT&CK"
    icon: "cogs"
    permanent: true  # TTPs are reference data and should not decay
    decay_config:
      half_life_days: 365  # Long half-life for reference data
      importance_floor: 0.8  # High floor for TTPs
      stability_multiplier: 1.5  # High stability for reference data
    attributes:
      - name: "tactic_id"
        type: "string"
        required: false
        description: "MITRE ATT&CK tactic ID (e.g., TA0042)"
      - name: "tactic_name"
        type: "string"
        required: false
        description: "MITRE ATT&CK tactic name (e.g., Resource Development)"
      - name: "technique_id"
        type: "string"
        required: false
        description: "MITRE ATT&CK technique ID (e.g., T1566)"
      - name: "technique_name"
        type: "string"
        required: false
        description: "MITRE ATT&CK technique name (e.g., Phishing)"
      - name: "description"
        type: "string"
        required: false
        description: "Description of the TTP"
      - name: "mitre_url"
        type: "string"
        required: false
        description: "URL to MITRE ATT&CK reference"

  - name: "Account"
    description: "User accounts on social media platforms, forums, and other online services"
    icon: "user"
    permanent: false
    decay_config:
      half_life_days: 90  # Account activity changes moderately
      importance_floor: 0.4
      stability_multiplier: 0.9
    attributes:
      - name: "platform"
        type: "string"
        required: false
        description: "Platform name (e.g., Twitter, Telegram, Facebook, Instagram)"
      - name: "username"
        type: "string"
        required: false
        description: "Username or handle on the platform"
      - name: "user_id"
        type: "string"
        required: false
        description: "Platform-specific user ID"
      - name: "display_name"
        type: "string"
        required: false
        description: "Display name or profile name"
      - name: "verified"
        type: "boolean"
        required: false
        description: "Whether the account is verified by the platform"
      - name: "follower_count"
        type: "number"
        required: false
        description: "Number of followers"
      - name: "account_created"
        type: "datetime"
        required: false
        description: "Account creation date"
      - name: "last_active"
        type: "datetime"
        required: false
        description: "Last activity timestamp"
      - name: "profile_url"
        type: "string"
        required: false
        description: "URL to the profile"
      - name: "bio"
        type: "string"
        required: false
        description: "Account biography or description"

  - name: "Domain"
    description: "Domain names including websites, registered domains, and DNS entries"
    icon: "globe"
    permanent: false
    decay_config:
      half_life_days: 120  # Domains have medium-term relevance
      importance_floor: 0.4
      stability_multiplier: 1.0
    attributes:
      - name: "domain_name"
        type: "string"
        required: false
        description: "Fully qualified domain name (e.g., example.com)"
      - name: "tld"
        type: "string"
        required: false
        description: "Top-level domain (e.g., .com, .org, .io)"
      - name: "registered_date"
        type: "datetime"
        required: false
        description: "Domain registration date"
      - name: "expiry_date"
        type: "datetime"
        required: false
        description: "Domain expiration date"
      - name: "registrar"
        type: "string"
        required: false
        description: "Domain registrar"
      - name: "nameservers"
        type: "list"
        required: false
        description: "List of nameservers"
      - name: "dns_records"
        type: "list"
        required: false
        description: "DNS record types (A, AAAA, MX, TXT, etc.)"
      - name: "status"
        type: "string"
        required: false
        description: "Domain status (e.g., active, suspended, expired)"
      - name: "ssl_valid"
        type: "boolean"
        required: false
        description: "Whether SSL certificate is valid"

  - name: "Email"
    description: "Email addresses for communication and account association"
    icon: "envelope"
    permanent: false
    decay_config:
      half_life_days: 90  # Email addresses have moderate relevance
      importance_floor: 0.3
      stability_multiplier: 0.8
    attributes:
      - name: "email_address"
        type: "string"
        required: false
        description: "Full email address"
      - name: "domain"
        type: "string"
        required: false
        description: "Email domain (e.g., gmail.com, protonmail.com)"
      - name: "username"
        type: "string"
        required: false
        description: "Email username (local part)"
      - name: "verified"
        type: "boolean"
        required: false
        description: "Whether the email is verified"
      - name: "data_breach"
        type: "boolean"
        required: false
        description: "Whether found in known data breaches"
      - name: "breach_sources"
        type: "list"
        required: false
        description: "List of data breach sources"
      - name: "first_seen"
        type: "datetime"
        required: false
        description: "First time this email was observed"

  - name: "Phone"
    description: "Phone numbers including mobile, landline, and VoIP"
    icon: "phone"
    permanent: false
    decay_config:
      half_life_days: 120  # Phone numbers have medium-term relevance
      importance_floor: 0.4
      stability_multiplier: 0.9
    attributes:
      - name: "phone_number"
        type: "string"
        required: false
        description: "Phone number in E.164 format if possible"
      - name: "country_code"
        type: "string"
        required: false
        description: "Country calling code (e.g., +1, +44, +61)"
      - name: "type"
        type: "string"
        required: false
        description: "Phone type (e.g., mobile, landline, voip)"
      - name: "carrier"
        type: "string"
        required: false
        description: "Mobile carrier or service provider"
      - name: "whatsapp_linked"
        type: "boolean"
        required: false
        description: "Whether linked to WhatsApp account"
      - name: "telegram_linked"
        type: "boolean"
        required: false
        description: "Whether linked to Telegram account"
      - name: "signal_linked"
        type: "boolean"
        required: false
        description: "Whether linked to Signal account"
      - name: "verified"
        type: "boolean"
        required: false
        description: "Whether the number is verified"

  - name: "Image"
    description: "Images including profile photos, screenshots, and other visual media with metadata"
    icon: "image"
    permanent: false
    decay_config:
      half_life_days: 60  # Images have shorter relevance
      importance_floor: 0.3
      stability_multiplier: 0.7
    attributes:
      - name: "url"
        type: "string"
        required: false
        description: "Image URL or file path"
      - name: "hash"
        type: "string"
        required: false
        description: "Perceptual hash or checksum for deduplication"
      - name: "mime_type"
        type: "string"
        required: false
        description: "MIME type (e.g., image/jpeg, image/png)"
      - name: "width"
        type: "number"
        required: false
        description: "Image width in pixels"
      - name: "height"
        type: "number"
        required: false
        description: "Image height in pixels"
      - name: "exif_data"
        type: "string"
        required: false
        description: "EXIF metadata (geolocation, device, timestamp)"
      - name: "reverse_search_results"
        type: "list"
        required: false
        description: "Results from reverse image search"
      - name: "source"
        type: "string"
        required: false
        description: "Source where image was found"
      - name: "is_profile_photo"
        type: "boolean"
        required: false
        description: "Whether image is used as a profile photo"
      - name: "faces_detected"
        type: "number"
        required: false
        description: "Number of faces detected in image"

  - name: "Investigation"
    description: "Investigation case or project tracking for OSINT/CTI research"
    icon: "folder-open"
    permanent: false
    decay_config:
      half_life_days: 365  # Investigations have long-term relevance
      importance_floor: 0.6
      stability_multiplier: 1.2
    attributes:
      - name: "case_number"
        type: "string"
        required: false
        description: "Unique case or investigation identifier"
      - name: "title"
        type: "string"
        required: false
        description: "Investigation title"
      - name: "description"
        type: "string"
        required: false
        description: "Investigation description and objectives"
      - name: "status"
        type: "string"
        required: false
        description: "Investigation status (e.g., open, in_progress, closed, archived)"
      - name: "priority"
        type: "string"
        required: false
        description: "Priority level (e.g., critical, high, medium, low)"
      - name: "classification"
        type: "string"
        required: false
        description: "Classification level (e.g., public, confidential, secret)"
      - name: "created_date"
        type: "datetime"
        required: false
        description: "Investigation creation date"
      - name: "closed_date"
        type: "datetime"
        required: false
        description: "Investigation closure date"
      - name: "assigned_to"
        type: "string"
        required: false
        description: "Investigator or team assigned"
      - name: "tags"
        type: "list"
        required: false
        description: "Investigation tags for categorization"

# Custom relationship types define domain-specific connections between entities
relationship_types:
  - name: "uses"
    description: "Threat actor uses malware or tools in their operations"
    source_entity_types: ["ThreatActor"]
    target_entity_types: ["Malware", "TTP", "Infrastructure"]
    bidirectional: false
    attributes:
      - name: "confidence"
        type: "string"
        required: false
        description: "Confidence in the relationship"
      - name: "first_observed"
        type: "datetime"
        required: false
        description: "When the usage was first observed"

  - name: "targets"
    description: "Threat actor or campaign targets specific organizations or sectors"
    source_entity_types: ["ThreatActor", "Campaign"]
    target_entity_types: ["Organization", "Person", "Infrastructure"]
    bidirectional: false
    inverse_name: "targeted_by"
    attributes:
      - name: "motivation"
        type: "string"
        required: false
        description: "Motivation for targeting (e.g., espionage, financial)"
      - name: "intensity"
        type: "string"
        required: false
        description: "Intensity of targeting (e.g., high, medium, low)"

  - name: "associated_with"
    description: "General association between entities (e.g., indicator associated with campaign)"
    source_entity_types: ["Indicator", "Infrastructure", "Malware"]
    target_entity_types: ["Campaign", "ThreatActor", "Malware"]
    bidirectional: true
    attributes:
      - name: "confidence"
        type: "string"
        required: false
        description: "Confidence level of the association"

  - name: "attributed_to"
    description: "Campaign or activity attributed to a specific threat actor"
    source_entity_types: ["Campaign", "Infrastructure"]
    target_entity_types: ["ThreatActor"]
    bidirectional: false
    inverse_name: "attributed_campaigns"
    attributes:
      - name: "confidence"
        type: "string"
        required: false
        description: "Attribution confidence level"
      - name: "attribution_method"
        type: "string"
        required: false
        description: "Method of attribution (e.g., code-analysis, infrastructure-overlap)"

  - name: "exploits"
    description: "Malware exploits a specific vulnerability"
    source_entity_types: ["Malware", "ThreatActor", "TTP"]
    target_entity_types: ["Vulnerability"]
    bidirectional: false
    inverse_name: "exploited_by"
    attributes:
      - name: "exploit_type"
        type: "string"
        required: false
        description: "Type of exploit (e.g., zero-day, known)"

  - name: "variant_of"
    description: "Malware is a variant of another malware family"
    source_entity_types: ["Malware"]
    target_entity_types: ["Malware"]
    bidirectional: false
    inverse_name: "has_variant"
    attributes:
      - name: "similarity_score"
        type: "number"
        required: false
        description: "Similarity score (0.0-1.0)"

  - name: "located_at"
    description: "Infrastructure is located at a specific geographic location or hosted by an ISP"
    source_entity_types: ["Infrastructure"]
    target_entity_types: ["Location", "Organization"]
    bidirectional: false
    inverse_name: "hosts"
    attributes:
      - name: "is_primary"
        type: "boolean"
        required: false
        description: "Whether this is the primary location"

  - name: "communicates_with"
    description: "Infrastructure communicates with other infrastructure (e.g., C2 beacons)"
    source_entity_types: ["Infrastructure"]
    target_entity_types: ["Infrastructure"]
    bidirectional: true
    attributes:
      - name: "protocol"
        type: "string"
        required: false
        description: "Communication protocol (e.g., HTTP, DNS, HTTPS)"
      - name: "frequency"
        type: "string"
        required: false
        description: "Communication frequency (e.g., daily, hourly)"

  # OSINT Relationship Types

  - name: "owns"
    description: "Person or organization owns an account, domain, or phone number"
    source_entity_types: ["Person", "Organization"]
    target_entity_types: ["Account", "Domain", "Email", "Phone"]
    bidirectional: false
    inverse_name: "owned_by"
    attributes:
      - name: "verified"
        type: "boolean"
        required: false
        description: "Whether ownership is verified"
      - name: "since"
        type: "datetime"
        required: false
        description: "When ownership started"
      - name: "is_primary"
        type: "boolean"
        required: false
        description: "Whether this is the primary ownership"

  - name: "registered_to"
    description: "Domain is registered to a person or organization"
    source_entity_types: ["Domain"]
    target_entity_types: ["Person", "Organization"]
    bidirectional: false
    inverse_name: "registered_domains"
    attributes:
      - name: "registrar"
        type: "string"
        required: false
        description: "Domain registrar"
      - name: "registered_date"
        type: "datetime"
        required: false
        description: "Registration date"
      - name: "privacy_protected"
        type: "boolean"
        required: false
        description: "Whether WHOIS privacy is enabled"

  - name: "hosted_on"
    description: "Domain or account is hosted on infrastructure or platform"
    source_entity_types: ["Domain", "Account"]
    target_entity_types: ["Infrastructure", "Organization"]
    bidirectional: false
    inverse_name: "hosts"
    attributes:
      - name: "hosting_provider"
        type: "string"
        required: false
        description: "Hosting provider name"
      - name: "ip_address"
        type: "string"
        required: false
        description: "IP address of hosting"
      - name: "nameserver"
        type: "string"
        required: false
        description: "Nameserver for domain"

  - name: "contacted_via"
    description: "Person contacted through specific channel (email, phone, account)"
    source_entity_types: ["Person", "Organization"]
    target_entity_types: ["Email", "Phone", "Account"]
    bidirectional: false
    inverse_name: "contacted"
    attributes:
      - name: "contact_date"
        type: "datetime"
        required: false
        description: "When contact was made"
      - name: "contact_type"
        type: "string"
        required: false
        description: "Type of contact (e.g., inquiry, threat, solicitation)"
      - name: "frequency"
        type: "string"
        required: false
        description: "Contact frequency (e.g., once, recurring)"

  - name: "contains"
    description: "Entity contains or embeds other entities (e.g., account bio contains email, website contains phone)"
    source_entity_types: ["Account", "Domain", "Image"]
    target_entity_types: ["Email", "Phone", "Domain", "Account", "Image"]
    bidirectional: false
    inverse_name: "contained_in"
    attributes:
      - name: "location"
        type: "string"
        required: false
        description: "Where the entity is contained (e.g., bio, description, metadata)"
      - name: "extracted_date"
        type: "datetime"
        required: false
        description: "When the containment was discovered"
      - name: "confidence"
        type: "string"
        required: false
        description: "Confidence in the extraction"

  - name: "investigates"
    description: "Investigation focuses on or investigates specific entities"
    source_entity_types: ["Investigation"]
    target_entity_types: ["Person", "Organization", "Account", "Domain", "Email", "Phone", "ThreatActor", "Malware", "Campaign"]
    bidirectional: false
    inverse_name: "investigated_in"
    attributes:
      - name: "focus_area"
        type: "string"
        required: false
        description: "Area of investigation focus"
      - name: "relevance"
        type: "string"
        required: false
        description: "Relevance to investigation (e.g., primary, secondary, background)"
      - name: "added_date"
        type: "datetime"
        required: false
        description: "When entity was added to investigation"

  - name: "links_to"
    description: "Account or domain links to another account, domain, or URL (outbound connection)"
    source_entity_types: ["Account", "Domain"]
    target_entity_types: ["Account", "Domain", "Infrastructure"]
    bidirectional: false
    inverse_name: "linked_from"
    attributes:
      - name: "link_type"
        type: "string"
        required: false
        description: "Type of link (e.g., profile, post, redirect, shared)"
      - name: "context"
        type: "string"
        required: false
        description: "Context of the link"
      - name: "discovered_date"
        type: "datetime"
        required: false
        description: "When the link was discovered"

  - name: "exposes"
    description: "Entity exposes information about another entity (e.g., data breach exposes credentials, image exposes location)"
    source_entity_types: ["Image", "Email", "Account", "Domain", "Investigation"]
    target_entity_types: ["Person", "Phone", "Email", "Location", "Account"]
    bidirectional: false
    inverse_name: "exposed_by"
    attributes:
      - name: "exposure_type"
        type: "string"
        required: false
        description: "Type of exposure (e.g., data_breach, exif leak, accidental disclosure)"
      - name: "severity"
        type: "string"
        required: false
        description: "Severity of exposure (e.g., critical, high, medium, low)"
      - name: "exposure_date"
        type: "datetime"
        required: false
        description: "When the exposure occurred"

  - name: "similar_to"
    description: "Entities are similar (e.g., similar usernames, similar profile photos, similar domains)"
    source_entity_types: ["Account", "Domain", "Image", "Email"]
    target_entity_types: ["Account", "Domain", "Image", "Email"]
    bidirectional: true
    attributes:
      - name: "similarity_score"
        type: "number"
        required: false
        description: "Similarity score (0.0-1.0)"
      - name: "similarity_reason"
        type: "string"
        required: false
        description: "Reason for similarity (e.g., username_pattern, visual_hash, domain_structure)"
      - name: "calculated_date"
        type: "datetime"
        required: false
        description: "When similarity was calculated"
